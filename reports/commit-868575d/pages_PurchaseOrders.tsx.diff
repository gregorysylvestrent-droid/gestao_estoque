diff --git a/pages/PurchaseOrders.tsx b/pages/PurchaseOrders.tsx
index 82e791d..251f9cb 100644
--- a/pages/PurchaseOrders.tsx
+++ b/pages/PurchaseOrders.tsx
@@ -2,7 +2,16 @@
 import React, { useState, useMemo, useRef, useEffect } from 'react';
 import { PurchaseOrder, Vendor, InventoryItem, Quote, User, PO_STATUS_LABELS, CyclicBatch, CyclicCount, Vehicle } from '../types';
 import { PaginationBar } from '../components/PaginationBar';
-import { formatDatePtBR, formatDateTimePtBR, splitDateTimePtBR } from '../utils/dateTime';
+import { formatDatePtBR, formatDateTimePtBR, parseDateLike, splitDateTimePtBR } from '../utils/dateTime';
+
+type PoSortKey = 'id' | 'product' | 'plateCenter' | 'status' | 'priority';
+type PoSortDirection = 'asc' | 'desc';
+type ItemQuoteForm = {
+  vendorId: string;
+  totalValue: string;
+  validUntil: string;
+  notes: string;
+};
 
 interface PurchaseOrdersProps {
   user: User;
@@ -37,7 +46,7 @@ const getStatusColor = (status: PurchaseOrder['status']) => {
   }
 };
 
-const StatusProgressBar: React.FC<{ order: PurchaseOrder }> = ({ order }) => {
+const StatusProgressBar: React.FC<{ order: PurchaseOrder; onPrint?: () => void }> = ({ order, onPrint }) => {
   const { status } = order;
 
   // Colored Illustrative SVGs
@@ -195,13 +204,31 @@ const StatusProgressBar: React.FC<{ order: PurchaseOrder }> = ({ order }) => {
           </div>
         </div>
 
-        <button className="flex items-center gap-2 group text-[#0f172a] dark:text-primary transition-all hover:translate-x-1">
-          <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
-            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
-            <polyline points="14 2 14 8 20 8" />
-          </svg>
-          <span className="text-[10px] font-black uppercase tracking-widest underline underline-offset-4">Visualizar Nota Fiscal Eletrônica</span>
-        </button>
+        <div className="flex items-center gap-3 flex-wrap">
+          {onPrint && (
+            <button
+              type="button"
+              onClick={onPrint}
+              className="px-4 py-2 bg-gradient-to-r from-slate-800 to-slate-700 text-white border border-slate-700 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:from-slate-900 hover:to-slate-800 transition-all shadow-lg shadow-slate-900/20 flex items-center gap-2"
+              title={`Imprimir detalhamento do pedido ${order.id}`}
+            >
+              <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+                <polyline points="6 9 6 2 18 2 18 9" />
+                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
+                <rect width="12" height="8" x="6" y="14" />
+              </svg>
+              Imprimir
+            </button>
+          )}
+
+          <button className="flex items-center gap-2 group text-[#0f172a] dark:text-primary transition-all hover:translate-x-1">
+            <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
+              <polyline points="14 2 14 8 20 8" />
+            </svg>
+            <span className="text-[10px] font-black uppercase tracking-widest underline underline-offset-4">Visualizar Nota Fiscal Eletrônica</span>
+          </button>
+        </div>
       </div>
 
       {/* Detailed Log Table */}
@@ -304,6 +331,12 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   const [sendingPO, setSendingPO] = useState<PurchaseOrder | null>(null);
   const [vendorOrderNum, setVendorOrderNum] = useState('');
   const [quotationMode, setQuotationMode] = useState<'edit' | 'analyze'>('edit');
+  const [poSearch, setPoSearch] = useState('');
+  const [poPlateFilter, setPoPlateFilter] = useState('');
+  const [poCostCenterFilter, setPoCostCenterFilter] = useState('');
+  const [poSortKey, setPoSortKey] = useState<PoSortKey>('id');
+  const [poSortDirection, setPoSortDirection] = useState<PoSortDirection>('desc');
+  const [visibleQuoteForms, setVisibleQuoteForms] = useState(1);
 
   // Form State
   const [plate, setPlate] = useState('');
@@ -328,6 +361,14 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
       .filter(v => (v.plate || '').toLowerCase().includes(search) || (v.model || '').toLowerCase().includes(search))
       .slice(0, 5);
   }, [plate, vehicles, isPlateSearchOpen]);
+  const selectedVehicle = useMemo(() => {
+    if (!quotingPO?.plate) return undefined;
+    return vehicles.find(v => String(v.plate || '').toUpperCase() === String(quotingPO.plate || '').toUpperCase()) as (Vehicle & {
+      chassis?: string;
+      year?: number | string;
+      renavam?: string;
+    }) | undefined;
+  }, [vehicles, quotingPO]);
 
   // Form State
   // Rejection Modal State
@@ -338,30 +379,45 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   const [priority, setPriority] = useState<'normal' | 'urgente'>('normal');
   const [itemsList, setItemsList] = useState<{ sku: string; name: string; qty: number; price: number }[]>([]);
 
-  // Quotation Form State
+  // Legacy quotation state (mantido temporariamente para compatibilidade visual)
   const [quote1Vendor, setQuote1Vendor] = useState('');
   const [quote1Price, setQuote1Price] = useState('');
   const [quote1Notes, setQuote1Notes] = useState('');
   const [quote1Valid, setQuote1Valid] = useState('');
   const [quote1Search, setQuote1Search] = useState('');
   const [isQuote1SearchOpen, setIsQuote1SearchOpen] = useState(false);
-
   const [quote2Vendor, setQuote2Vendor] = useState('');
   const [quote2Price, setQuote2Price] = useState('');
   const [quote2Notes, setQuote2Notes] = useState('');
   const [quote2Valid, setQuote2Valid] = useState('');
   const [quote2Search, setQuote2Search] = useState('');
   const [isQuote2SearchOpen, setIsQuote2SearchOpen] = useState(false);
-
   const [quote3Vendor, setQuote3Vendor] = useState('');
   const [quote3Price, setQuote3Price] = useState('');
   const [quote3Notes, setQuote3Notes] = useState('');
   const [quote3Valid, setQuote3Valid] = useState('');
   const [quote3Search, setQuote3Search] = useState('');
   const [isQuote3SearchOpen, setIsQuote3SearchOpen] = useState(false);
-
+  const [quote4Vendor, setQuote4Vendor] = useState('');
+  const [quote4Price, setQuote4Price] = useState('');
+  const [quote4Notes, setQuote4Notes] = useState('');
+  const [quote4Valid, setQuote4Valid] = useState('');
+  const [quote4Search, setQuote4Search] = useState('');
+  const [isQuote4SearchOpen, setIsQuote4SearchOpen] = useState(false);
+  const [quote5Vendor, setQuote5Vendor] = useState('');
+  const [quote5Price, setQuote5Price] = useState('');
+  const [quote5Notes, setQuote5Notes] = useState('');
+  const [quote5Valid, setQuote5Valid] = useState('');
+  const [quote5Search, setQuote5Search] = useState('');
+  const [isQuote5SearchOpen, setIsQuote5SearchOpen] = useState(false);
   const [selectedQuoteId, setSelectedQuoteId] = useState('');
 
+  // Quotation Form State (por item e por slot)
+  const [itemQuoteForms, setItemQuoteForms] = useState<Record<string, ItemQuoteForm[]>>({});
+  const [itemVisibleQuoteForms, setItemVisibleQuoteForms] = useState<Record<string, number>>({});
+  const [itemVendorSearch, setItemVendorSearch] = useState<Record<string, string[]>>({});
+  const [itemVendorSearchOpen, setItemVendorSearchOpen] = useState<Record<string, boolean[]>>({});
+
   // Single Item Draft
   const [draftSku, setDraftSku] = useState('');
   const [draftQty, setDraftQty] = useState(0);
@@ -369,25 +425,17 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   const [itemSearch, setItemSearch] = useState('');
   const [isSearchDropdownOpen, setIsSearchDropdownOpen] = useState(false);
   const searchRef = useRef<HTMLDivElement>(null);
-
   const quote1SearchRef = useRef<HTMLDivElement>(null);
   const quote2SearchRef = useRef<HTMLDivElement>(null);
   const quote3SearchRef = useRef<HTMLDivElement>(null);
+  const quote4SearchRef = useRef<HTMLDivElement>(null);
+  const quote5SearchRef = useRef<HTMLDivElement>(null);
 
   useEffect(() => {
     const handleClickOutside = (event: MouseEvent) => {
       if (searchRef.current && !searchRef.current.contains(event.target as Node)) {
         setIsSearchDropdownOpen(false);
       }
-      if (quote1SearchRef.current && !quote1SearchRef.current.contains(event.target as Node)) {
-        setIsQuote1SearchOpen(false);
-      }
-      if (quote2SearchRef.current && !quote2SearchRef.current.contains(event.target as Node)) {
-        setIsQuote2SearchOpen(false);
-      }
-      if (quote3SearchRef.current && !quote3SearchRef.current.contains(event.target as Node)) {
-        setIsQuote3SearchOpen(false);
-      }
     };
     document.addEventListener('mousedown', handleClickOutside);
     return () => document.removeEventListener('mousedown', handleClickOutside);
@@ -408,6 +456,213 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   }, [itemSearch, inventory]);
 
   const totalOrder = useMemo(() => itemsList.reduce((acc, curr) => acc + (curr.qty * curr.price), 0), [itemsList]);
+  const filteredSortedOrders = useMemo(() => {
+    const normalize = (value: unknown) =>
+      String(value ?? '')
+        .normalize('NFD')
+        .replace(/[\u0300-\u036f]/g, '')
+        .toLowerCase()
+        .trim();
+
+    const search = normalize(poSearch);
+    const plateFilter = normalize(poPlateFilter);
+    const costCenterFilter = normalize(poCostCenterFilter);
+
+    const baseOrders = orders.filter((order) => {
+      const itemsJoined = (order.items || [])
+        .map((item) => `${item.name || ''} ${item.sku || ''}`)
+        .join(' | ');
+      const haystack = normalize([
+        order.id,
+        order.requestDate,
+        order.vendor,
+        order.requester,
+        order.plate,
+        order.costCenter,
+        PO_STATUS_LABELS[order.status] || order.status,
+        order.priority,
+        itemsJoined,
+        order.vendorOrderNumber,
+      ].join(' '));
+
+      const matchesSearch = !search || haystack.includes(search);
+      const matchesPlate = !plateFilter || normalize(order.plate).includes(plateFilter);
+      const matchesCostCenter = !costCenterFilter || normalize(order.costCenter).includes(costCenterFilter);
+      return matchesSearch && matchesPlate && matchesCostCenter;
+    });
+
+    return baseOrders.sort((a, b) => {
+      const factor = poSortDirection === 'asc' ? 1 : -1;
+      const valueA: Record<PoSortKey, string> = {
+        id: String(a.id || ''),
+        product: `${a.items?.[0]?.name || ''} ${a.items?.[0]?.sku || ''}`,
+        plateCenter: `${a.plate || ''} ${a.costCenter || ''}`,
+        status: String(PO_STATUS_LABELS[a.status] || a.status),
+        priority: String(a.priority || ''),
+      };
+      const valueB: Record<PoSortKey, string> = {
+        id: String(b.id || ''),
+        product: `${b.items?.[0]?.name || ''} ${b.items?.[0]?.sku || ''}`,
+        plateCenter: `${b.plate || ''} ${b.costCenter || ''}`,
+        status: String(PO_STATUS_LABELS[b.status] || b.status),
+        priority: String(b.priority || ''),
+      };
+      return valueA[poSortKey].localeCompare(valueB[poSortKey], 'pt-BR', { numeric: true }) * factor;
+    });
+  }, [orders, poSearch, poPlateFilter, poCostCenterFilter, poSortKey, poSortDirection]);
+
+  const costCenterOptions = useMemo(() => {
+    const values = new Set<string>();
+    orders.forEach((order) => {
+      const value = String(order.costCenter || '').trim();
+      if (value) values.add(value);
+    });
+    return Array.from(values).sort((a, b) => a.localeCompare(b, 'pt-BR'));
+  }, [orders]);
+
+  const togglePoSort = (key: PoSortKey) => {
+    if (poSortKey === key) {
+      setPoSortDirection((prev) => (prev === 'asc' ? 'desc' : 'asc'));
+      return;
+    }
+    setPoSortKey(key);
+    setPoSortDirection('asc');
+  };
+
+  const createEmptyItemQuoteForm = (): ItemQuoteForm => ({
+    vendorId: '',
+    totalValue: '',
+    validUntil: '',
+    notes: '',
+  });
+
+  const buildEmptyItemForms = () =>
+    Array.from({ length: 5 }, () => createEmptyItemQuoteForm());
+
+  const initializeItemQuoteState = (order: PurchaseOrder) => {
+    const formsByItem: Record<string, ItemQuoteForm[]> = {};
+    const visibleByItem: Record<string, number> = {};
+    const searchByItem: Record<string, string[]> = {};
+    const searchOpenByItem: Record<string, boolean[]> = {};
+
+    order.items.forEach((item) => {
+      const forms = buildEmptyItemForms();
+      (order.quotes || []).slice(0, 5).forEach((quote, index) => {
+        const quotedItem = quote.items?.find((entry) => entry.sku === item.sku);
+        if (!quotedItem) return;
+        const computedItemTotal = Number((quotedItem.unitPrice || 0) * Number(item.qty || 0));
+        forms[index] = {
+          vendorId: String(quote.vendorId || ''),
+          totalValue: Number.isFinite(computedItemTotal) && computedItemTotal > 0
+            ? computedItemTotal.toFixed(2)
+            : '',
+          validUntil: String(quote.validUntil || ''),
+          notes: String(quote.notes || ''),
+        };
+      });
+
+      const filledCount = forms.filter((form) => form.vendorId || form.totalValue).length;
+      visibleByItem[item.sku] = Math.max(1, Math.min(5, filledCount || order.quotes?.length || 1));
+      formsByItem[item.sku] = forms;
+      searchByItem[item.sku] = forms.map((form) => {
+        if (!form.vendorId) return '';
+        return vendors.find((vendor) => vendor.id === form.vendorId)?.name || '';
+      });
+      searchOpenByItem[item.sku] = Array.from({ length: 5 }, () => false);
+    });
+
+    setItemQuoteForms(formsByItem);
+    setItemVisibleQuoteForms(visibleByItem);
+    setItemVendorSearch(searchByItem);
+    setItemVendorSearchOpen(searchOpenByItem);
+  };
+
+  const getItemForm = (sku: string, index: number): ItemQuoteForm => {
+    const forms = itemQuoteForms[sku];
+    if (!forms || !forms[index]) return createEmptyItemQuoteForm();
+    return forms[index];
+  };
+
+  const updateItemForm = (sku: string, index: number, patch: Partial<ItemQuoteForm>) => {
+    setItemQuoteForms((prev) => {
+      const next = { ...prev };
+      const forms = (next[sku] || buildEmptyItemForms()).slice(0, 5);
+      const current = forms[index] || createEmptyItemQuoteForm();
+      forms[index] = { ...current, ...patch };
+      next[sku] = forms;
+      return next;
+    });
+  };
+
+  const getItemVendorSearchValue = (sku: string, index: number) => {
+    const searches = itemVendorSearch[sku];
+    if (!searches || searches[index] === undefined) return '';
+    return searches[index] || '';
+  };
+
+  const setItemVendorSearchValue = (sku: string, index: number, value: string) => {
+    setItemVendorSearch((prev) => {
+      const next = { ...prev };
+      const searches = (next[sku] || Array.from({ length: 5 }, () => '')).slice(0, 5);
+      searches[index] = value;
+      next[sku] = searches;
+      return next;
+    });
+  };
+
+  const isItemVendorSearchOpen = (sku: string, index: number) => {
+    const flags = itemVendorSearchOpen[sku];
+    return Boolean(flags && flags[index]);
+  };
+
+  const setItemVendorSearchOpenState = (sku: string, index: number, isOpen: boolean) => {
+    setItemVendorSearchOpen((prev) => {
+      const next = { ...prev };
+      const flags = (next[sku] || Array.from({ length: 5 }, () => false)).slice(0, 5);
+      flags[index] = isOpen;
+      next[sku] = flags;
+      return next;
+    });
+  };
+
+  const removeItemQuoteSlot = (sku: string, slotIndex: number) => {
+    if (slotIndex <= 0) return;
+
+    setItemQuoteForms((prev) => {
+      const next = { ...prev };
+      const forms = (next[sku] || buildEmptyItemForms()).slice(0, 5);
+      forms.splice(slotIndex, 1);
+      forms.push(createEmptyItemQuoteForm());
+      next[sku] = forms;
+      return next;
+    });
+
+    setItemVendorSearch((prev) => {
+      const next = { ...prev };
+      const searches = (next[sku] || Array.from({ length: 5 }, () => '')).slice(0, 5);
+      searches.splice(slotIndex, 1);
+      searches.push('');
+      next[sku] = searches;
+      return next;
+    });
+
+    setItemVendorSearchOpen((prev) => {
+      const next = { ...prev };
+      const flags = (next[sku] || Array.from({ length: 5 }, () => false)).slice(0, 5);
+      flags.splice(slotIndex, 1);
+      flags.push(false);
+      next[sku] = flags;
+      return next;
+    });
+
+    setItemVisibleQuoteForms((prev) => {
+      const current = prev[sku] ?? 1;
+      return {
+        ...prev,
+        [sku]: Math.max(1, Math.min(5, current - 1)),
+      };
+    });
+  };
 
   const handleAddItem = () => {
     if (!draftSku || draftQty <= 0) return;
@@ -473,138 +728,110 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   const handleOpenQuotationModal = (order: PurchaseOrder) => {
     setQuotingPO(order);
     setQuotationMode('edit');
-
-    // Pre-fill existing quotes (Safe checks)
-    if (order.quotes) {
-      if (order.quotes[0]) {
-        setQuote1Vendor(order.quotes[0].vendorId);
-        setQuote1Search(order.quotes[0].vendorName || '');
-        setQuote1Price(order.quotes[0].totalValue.toString());
-        setQuote1Notes(order.quotes[0].notes || '');
-        setQuote1Valid(order.quotes[0].validUntil);
-      }
-      if (order.quotes[1]) {
-        setQuote2Vendor(order.quotes[1].vendorId);
-        setQuote2Search(order.quotes[1].vendorName || '');
-        setQuote2Price(order.quotes[1].totalValue.toString());
-        setQuote2Notes(order.quotes[1].notes || '');
-        setQuote2Valid(order.quotes[1].validUntil);
-      }
-      if (order.quotes[2]) {
-        setQuote3Vendor(order.quotes[2].vendorId);
-        setQuote3Search(order.quotes[2].vendorName || '');
-        setQuote3Price(order.quotes[2].totalValue.toString());
-        setQuote3Notes(order.quotes[2].notes || '');
-        setQuote3Valid(order.quotes[2].validUntil);
-      }
-    }
-
+    initializeItemQuoteState(order);
     setIsQuotationModalOpen(true);
   };
 
   const handleOpenAnalyzeQuotation = (order: PurchaseOrder) => {
     setQuotingPO(order);
     setQuotationMode('analyze');
-
-    // Pre-fill existing quotes
-    if (order.quotes) {
-      if (order.quotes[0]) {
-        setQuote1Vendor(order.quotes[0].vendorId);
-        setQuote1Search(order.quotes[0].vendorName || '');
-        setQuote1Price(order.quotes[0].totalValue.toString());
-        setQuote1Notes(order.quotes[0].notes || '');
-        setQuote1Valid(order.quotes[0].validUntil);
-      }
-      if (order.quotes[1]) {
-        setQuote2Vendor(order.quotes[1].vendorId);
-        setQuote2Search(order.quotes[1].vendorName || '');
-        setQuote2Price(order.quotes[1].totalValue.toString());
-        setQuote2Notes(order.quotes[1].notes || '');
-        setQuote2Valid(order.quotes[1].validUntil);
-      }
-      if (order.quotes[2]) {
-        setQuote3Vendor(order.quotes[2].vendorId);
-        setQuote3Search(order.quotes[2].vendorName || '');
-        setQuote3Price(order.quotes[2].totalValue.toString());
-        setQuote3Notes(order.quotes[2].notes || '');
-        setQuote3Valid(order.quotes[2].validUntil);
-      }
-    }
-
+    initializeItemQuoteState(order);
     setIsQuotationModalOpen(true);
   };
 
   const handleSubmitQuotations = () => {
     if (!quotingPO) return;
+    const parseMoney = (raw: string) => {
+      const normalized = String(raw || '').replace(',', '.').trim();
+      const value = Number(normalized);
+      return Number.isFinite(value) ? value : 0;
+    };
 
-    // Verificar se pelo menos uma cotação foi preenchida (Vendor + Price)
-    const quote1Valid = quote1Vendor && quote1Price;
-    const quote2Valid = quote2Vendor && quote2Price;
-    const quote3Valid = quote3Vendor && quote3Price;
+    const now = Date.now();
+    const quotes: Quote[] = [];
 
-    if (!quote1Valid && !quote2Valid && !quote3Valid) {
-      alert('Por favor, preencha pelo menos 1 cotação (Fornecedor e Valor)');
-      return;
-    }
+    for (let slotIndex = 0; slotIndex < 5; slotIndex += 1) {
+      const slotEntries = quotingPO.items.map((item) => {
+        const visibleSlots = itemVisibleQuoteForms[item.sku] ?? 1;
+        const form = getItemForm(item.sku, slotIndex);
+        return {
+          item,
+          visible: slotIndex < visibleSlots,
+          form,
+        };
+      });
 
-    // Validar fornecedores diferentes (apenas entre os preenchidos)
-    const filledVendorIds = [quote1Vendor, quote2Vendor, quote3Vendor].filter(Boolean);
-    const uniqueVendors = new Set(filledVendorIds);
-    if (filledVendorIds.length !== uniqueVendors.size) {
-      alert('Os fornecedores devem ser diferentes!');
-      return;
-    }
+      const visibleEntries = slotEntries.filter((entry) => entry.visible);
+      if (visibleEntries.length === 0) continue;
 
-    const quotes: Quote[] = [];
+      const anyFilled = visibleEntries.some(({ form }) =>
+        Boolean(form.vendorId || form.totalValue || form.validUntil || form.notes),
+      );
+      if (!anyFilled) continue;
 
-    if (quote1Valid) {
-      quotes.push({
-        id: `Q1-${Date.now()}`,
-        vendorId: quote1Vendor,
-        vendorName: vendors.find(v => v.id === quote1Vendor)?.name || '',
-        items: quotingPO.items.map(item => ({ sku: item.sku, unitPrice: parseFloat(quote1Price) / quotingPO.items.reduce((sum, i) => sum + i.qty, 0), leadTime: quote1Valid ? '7 dias' : '' })),
-        totalValue: parseFloat(quote1Price),
-        validUntil: formatDatePtBR(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), '--/--/----'),
-        notes: quote1Notes,
-        quotedBy: 'Comprador',
-        quotedAt: formatDateTimePtBR(new Date(), '--/--/---- --:--:--'),
-        isSelected: false
+      const hasInvalidRequired = visibleEntries.some(({ form }) => {
+        const total = parseMoney(form.totalValue);
+        return !form.vendorId || total <= 0;
       });
-    }
+      if (hasInvalidRequired) {
+        alert(`Preencha fornecedor e valor para todos os itens da cotação ${slotIndex + 1}.`);
+        return;
+      }
+
+      const vendorIds = new Set(visibleEntries.map(({ form }) => form.vendorId));
+      if (vendorIds.size !== 1) {
+        alert(`Na cotação ${slotIndex + 1}, use o mesmo fornecedor para todos os itens exibidos.`);
+        return;
+      }
+
+      const vendorId = visibleEntries[0].form.vendorId;
+      const vendorName = vendors.find((vendor) => vendor.id === vendorId)?.name || '';
+      const totalValue = visibleEntries.reduce((sum, { form }) => sum + parseMoney(form.totalValue), 0);
+      const validUntil = visibleEntries.find(({ form }) => form.validUntil)?.form.validUntil
+        || formatDatePtBR(new Date(now + 30 * 24 * 60 * 60 * 1000), '--/--/----');
+      const noteList = Array.from(
+        new Set(
+          visibleEntries
+            .map(({ form }) => String(form.notes || '').trim())
+            .filter(Boolean),
+        ),
+      );
+      const notes = noteList.join(' | ');
 
-    if (quote2Valid) {
       quotes.push({
-        id: `Q2-${Date.now() + 1}`,
-        vendorId: quote2Vendor,
-        vendorName: vendors.find(v => v.id === quote2Vendor)?.name || '',
-        items: quotingPO.items.map(item => ({ sku: item.sku, unitPrice: parseFloat(quote2Price) / quotingPO.items.reduce((sum, i) => sum + i.qty, 0), leadTime: quote2Valid ? '7 dias' : '' })),
-        totalValue: parseFloat(quote2Price),
-        validUntil: formatDatePtBR(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), '--/--/----'),
-        notes: quote2Notes,
-        quotedBy: 'Comprador',
+        id: `Q${slotIndex + 1}-${now + slotIndex}`,
+        vendorId,
+        vendorName,
+        items: visibleEntries.map(({ item, form }) => {
+          const itemTotal = parseMoney(form.totalValue);
+          const qty = Number(item.qty || 0);
+          const safeQty = qty > 0 ? qty : 1;
+          return {
+            sku: item.sku,
+            unitPrice: itemTotal / safeQty,
+            leadTime: '7 dias',
+          };
+        }),
+        totalValue,
+        validUntil,
+        notes,
+        quotedBy: user.name || 'Comprador',
         quotedAt: formatDateTimePtBR(new Date(), '--/--/---- --:--:--'),
-        isSelected: false
+        isSelected: false,
       });
     }
 
-    if (quote3Valid) {
-      quotes.push({
-        id: `Q3-${Date.now() + 2}`,
-        vendorId: quote3Vendor,
-        vendorName: vendors.find(v => v.id === quote3Vendor)?.name || '',
-        items: quotingPO.items.map(item => ({ sku: item.sku, unitPrice: parseFloat(quote3Price) / quotingPO.items.reduce((sum, i) => sum + i.qty, 0), leadTime: quote3Valid ? '7 dias' : '' })),
-        totalValue: parseFloat(quote3Price),
-        validUntil: formatDatePtBR(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), '--/--/----'),
-        notes: quote3Notes,
-        quotedBy: 'Comprador',
-        quotedAt: formatDateTimePtBR(new Date(), '--/--/---- --:--:--'),
-        isSelected: false
-      });
+    if (quotes.length === 0) {
+      alert('Preencha pelo menos 1 cotação válida.');
+      return;
     }
 
-    // Fix vendor names
-    // Note: I cannot access 'vendors' prop arrays easily inside this function without more context of 'vendors' variable scope. 
-    // Assuming 'vendors' is available in scope as per previous view_file.
+    const quoteVendorIds = quotes.map((quote) => quote.vendorId).filter(Boolean);
+    const uniqueVendorIds = new Set(quoteVendorIds);
+    if (quoteVendorIds.length !== uniqueVendorIds.size) {
+      alert('Os fornecedores devem ser diferentes entre as cotações preenchidas.');
+      return;
+    }
 
     onAddQuotes(quotingPO.id, quotes);
     setIsQuotationModalOpen(false);
@@ -612,22 +839,10 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
   };
 
   const resetQuotationForm = () => {
-    setQuote1Vendor('');
-    setQuote1Search('');
-    setQuote1Price('');
-    setQuote1Notes('');
-    setQuote1Valid('');
-    setQuote2Vendor('');
-    setQuote2Search('');
-    setQuote2Price('');
-    setQuote2Notes('');
-    setQuote2Valid('');
-    setQuote3Vendor('');
-    setQuote3Search('');
-    setQuote3Price('');
-    setQuote3Notes('');
-    setQuote3Valid('');
-    setSelectedQuoteId('');
+    setItemQuoteForms({});
+    setItemVisibleQuoteForms({});
+    setItemVendorSearch({});
+    setItemVendorSearchOpen({});
   };
 
   const handleSendQuotationToApproval = (order: PurchaseOrder) => {
@@ -660,6 +875,804 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
     setVendorOrderNum('');
   };
 
+  const escapeHtml = (value: unknown) =>
+    String(value ?? '')
+      .replace(/&/g, '&amp;')
+      .replace(/</g, '&lt;')
+      .replace(/>/g, '&gt;')
+      .replace(/"/g, '&quot;')
+      .replace(/'/g, '&#39;');
+
+  const formatCurrencyBRL = (value: number) =>
+    `R$ ${Number.isFinite(value) ? value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '0,00'}`;
+
+  const printHtmlDocument = (printableHtml: string) => {
+    const iframe = document.createElement('iframe');
+    iframe.setAttribute('aria-hidden', 'true');
+    iframe.style.position = 'fixed';
+    iframe.style.right = '0';
+    iframe.style.bottom = '0';
+    iframe.style.width = '0';
+    iframe.style.height = '0';
+    iframe.style.border = '0';
+    iframe.style.opacity = '0';
+    iframe.style.pointerEvents = 'none';
+    document.body.appendChild(iframe);
+
+    const cleanup = () => {
+      setTimeout(() => {
+        if (iframe.parentNode) {
+          iframe.parentNode.removeChild(iframe);
+        }
+      }, 500);
+    };
+
+    const printFromIframe = () => {
+      const win = iframe.contentWindow;
+      if (!win) {
+        cleanup();
+        alert('Não foi possível iniciar a impressão neste navegador.');
+        return;
+      }
+
+      win.onafterprint = cleanup;
+      win.focus();
+      win.print();
+      setTimeout(cleanup, 3000);
+    };
+
+    const doc = iframe.contentDocument || iframe.contentWindow?.document;
+    if (!doc) {
+      cleanup();
+      alert('Não foi possível preparar o documento para impressão.');
+      return;
+    }
+
+    doc.open();
+    doc.write(printableHtml);
+    doc.close();
+
+    if (iframe.contentWindow?.document.readyState === 'complete') {
+      setTimeout(printFromIframe, 220);
+    } else {
+      iframe.onload = () => {
+        setTimeout(printFromIframe, 220);
+      };
+    }
+  };
+
+  const handlePrintQuotationSheet = () => {
+    if (!quotingPO) return;
+
+    const parseQuoteValue = (raw: string) => {
+      const normalized = String(raw || '').replace(',', '.').trim();
+      const value = Number(normalized);
+      return Number.isFinite(value) ? value : 0;
+    };
+
+    const baseUrl = import.meta.env.BASE_URL || '/';
+    const normalizedBaseUrl = baseUrl.endsWith('/') ? baseUrl : `${baseUrl}/`;
+    const logoUrl = `${window.location.origin}${normalizedBaseUrl}norte_tech_logo.png`;
+    const issuedAt = formatDateTimePtBR(new Date(), '--/--/---- --:--:--');
+
+    const quotationItemsHtml = quotingPO.items.map((item) => {
+      const visibleSlots = Math.max(1, Math.min(5, itemVisibleQuoteForms[item.sku] ?? 1));
+      const rows = Array.from({ length: visibleSlots }).map((_, slotIndex) => {
+        const form = getItemForm(item.sku, slotIndex);
+        const vendor = vendors.find((entry) => entry.id === form.vendorId);
+        const totalValue = parseQuoteValue(form.totalValue);
+        const unitValue = Number(item.qty || 0) > 0 ? totalValue / Number(item.qty || 1) : 0;
+        const validUntil = form.validUntil ? formatDatePtBR(form.validUntil, '-') : '-';
+        const note = String(form.notes || '').trim() || '-';
+
+        return `
+          <tr>
+            <td>${slotIndex + 1}</td>
+            <td>${escapeHtml(vendor?.name || '-')}</td>
+            <td>${escapeHtml(vendor?.cnpj || '-')}</td>
+            <td class="ta-right">${totalValue > 0 ? formatCurrencyBRL(totalValue) : '-'}</td>
+            <td class="ta-right">${totalValue > 0 ? formatCurrencyBRL(unitValue) : '-'}</td>
+            <td>${escapeHtml(validUntil)}</td>
+            <td>${escapeHtml(note)}</td>
+          </tr>
+        `;
+      }).join('');
+
+      return `
+        <section class="item-card">
+          <div class="item-header">
+            <div>
+              <p class="item-name">${escapeHtml(item.name)}</p>
+              <p class="item-meta">Cód. Produto: ${escapeHtml(item.sku)}</p>
+            </div>
+            <div class="item-qty">${escapeHtml(item.qty)} un.</div>
+          </div>
+          <table class="quote-table">
+            <thead>
+              <tr>
+                <th>#</th>
+                <th>Fornecedor</th>
+                <th>CNPJ</th>
+                <th class="ta-right">Valor Total</th>
+                <th class="ta-right">Valor Unitário</th>
+                <th>Prazo</th>
+                <th>Observações</th>
+              </tr>
+            </thead>
+            <tbody>${rows}</tbody>
+          </table>
+        </section>
+      `;
+    }).join('');
+
+    const printableHtml = `
+      <!doctype html>
+      <html lang="pt-BR">
+      <head>
+        <meta charset="utf-8" />
+        <meta name="viewport" content="width=device-width, initial-scale=1" />
+        <title>Cotações ${escapeHtml(quotingPO.id)}</title>
+        <style>
+          @page { size: A4 portrait; margin: 10mm; }
+          * { box-sizing: border-box; }
+          body {
+            margin: 0;
+            padding: 18px;
+            font-family: "Segoe UI", "Inter", Arial, sans-serif;
+            background: #eef2f7;
+            color: #0f172a;
+          }
+          .sheet {
+            width: 100%;
+            max-width: 190mm;
+            margin: 0 auto;
+            background: #ffffff;
+            border: 1px solid #dbe2ea;
+            border-radius: 16px;
+            overflow: hidden;
+          }
+          .header {
+            display: flex;
+            gap: 14px;
+            align-items: center;
+            border-bottom: 1px solid #e5e7eb;
+            padding: 16px 18px;
+            background: linear-gradient(120deg, #f8fbff 0%, #eff6ff 100%);
+          }
+          .logo {
+            width: 62px;
+            height: 62px;
+            border-radius: 12px;
+            object-fit: cover;
+            border: 1px solid #dbe2ea;
+            background: #ffffff;
+          }
+          .title-wrap h1 {
+            margin: 0;
+            font-size: 18px;
+            line-height: 1.2;
+            font-weight: 800;
+            color: #1e3a8a;
+          }
+          .title-wrap p {
+            margin: 3px 0 0;
+            font-size: 11px;
+            color: #475569;
+            font-weight: 600;
+          }
+          .meta-grid {
+            display: grid;
+            grid-template-columns: repeat(2, minmax(0, 1fr));
+            gap: 8px 14px;
+            padding: 14px 18px;
+            border-bottom: 1px solid #e5e7eb;
+            background: #f8fafc;
+            font-size: 11px;
+          }
+          .meta-grid strong {
+            color: #1e293b;
+            min-width: 88px;
+            display: inline-block;
+          }
+          .content {
+            padding: 14px 18px 18px;
+          }
+          .item-card {
+            border: 1px solid #dbe2ea;
+            border-radius: 14px;
+            overflow: hidden;
+            margin-bottom: 12px;
+            break-inside: avoid;
+            page-break-inside: avoid;
+          }
+          .item-header {
+            display: flex;
+            justify-content: space-between;
+            align-items: center;
+            gap: 12px;
+            background: #f8fafc;
+            border-bottom: 1px solid #e5e7eb;
+            padding: 10px 12px;
+          }
+          .item-name {
+            margin: 0;
+            font-size: 12px;
+            font-weight: 800;
+          }
+          .item-meta {
+            margin: 2px 0 0;
+            font-size: 10px;
+            font-weight: 700;
+            color: #2563eb;
+          }
+          .item-qty {
+            font-size: 11px;
+            font-weight: 800;
+            color: #334155;
+            background: #ffffff;
+            border: 1px solid #e2e8f0;
+            border-radius: 999px;
+            padding: 4px 10px;
+            white-space: nowrap;
+          }
+          .quote-table {
+            width: 100%;
+            border-collapse: collapse;
+            table-layout: fixed;
+          }
+          .quote-table thead th {
+            text-align: left;
+            font-size: 10px;
+            text-transform: uppercase;
+            letter-spacing: 0.06em;
+            color: #64748b;
+            padding: 8px 10px;
+            background: #ffffff;
+            border-bottom: 1px solid #e5e7eb;
+          }
+          .quote-table tbody td {
+            padding: 8px 10px;
+            font-size: 10px;
+            border-bottom: 1px solid #f1f5f9;
+            color: #0f172a;
+            vertical-align: top;
+            word-break: break-word;
+          }
+          .quote-table tbody tr:last-child td {
+            border-bottom: 0;
+          }
+          .ta-right { text-align: right; }
+          .footer {
+            border-top: 1px solid #e5e7eb;
+            background: #f8fafc;
+            padding: 10px 18px;
+            font-size: 10px;
+            color: #64748b;
+            display: flex;
+            justify-content: space-between;
+            gap: 10px;
+            flex-wrap: wrap;
+          }
+          @media print {
+            body { background: #ffffff; padding: 0; }
+            .sheet {
+              max-width: none;
+              border: none;
+              border-radius: 0;
+              margin: 0;
+            }
+          }
+        </style>
+      </head>
+      <body>
+        <main class="sheet">
+          <header class="header">
+            <img class="logo" src="${logoUrl}" alt="Norte Tech" />
+            <div class="title-wrap">
+              <h1>Relatório de Cotações</h1>
+              <p>Pedido ${escapeHtml(quotingPO.id)} • Emitido em ${escapeHtml(issuedAt)}</p>
+            </div>
+          </header>
+
+          <section class="meta-grid">
+            <div><strong>Placa:</strong> ${escapeHtml(quotingPO.plate || '-')}</div>
+            <div><strong>Centro de Custo:</strong> ${escapeHtml(quotingPO.costCenter || '-')}</div>
+            <div><strong>Chassi:</strong> ${escapeHtml(selectedVehicle?.chassis || '-')}</div>
+            <div><strong>Ano:</strong> ${escapeHtml(selectedVehicle?.year ?? '-')}</div>
+            <div><strong>Renavam:</strong> ${escapeHtml(selectedVehicle?.renavam || '-')}</div>
+            <div><strong>Origem:</strong> ${escapeHtml(quotingPO.requester || '-')}</div>
+          </section>
+
+          <section class="content">
+            ${quotationItemsHtml}
+          </section>
+
+          <footer class="footer">
+            <span>Norte Tech WMS • Compras</span>
+            <span>Documento para análise e formalização de cotações</span>
+          </footer>
+        </main>
+      </body>
+      </html>
+    `;
+    printHtmlDocument(printableHtml);
+  };
+
+  const handlePrintOrderDetailSheet = (order: PurchaseOrder) => {
+    const baseUrl = import.meta.env.BASE_URL || '/';
+    const normalizedBaseUrl = baseUrl.endsWith('/') ? baseUrl : `${baseUrl}/`;
+    const logoUrl = `${window.location.origin}${normalizedBaseUrl}norte_tech_logo.png`;
+    const issuedAt = formatDateTimePtBR(new Date(), '--/--/---- --:--:--');
+    const statusLabel = PO_STATUS_LABELS[order.status] || order.status || '-';
+    const selectedQuote = (order.quotes || []).find((quote) => quote.id === order.selectedQuoteId);
+    const totalValue = Number(order.total || selectedQuote?.totalValue || 0);
+
+    const itemRows = (order.items || [])
+      .map((item, index) => {
+        const qty = Number(item.qty || 0);
+        const unit = Number(item.price || 0);
+        const subtotal = qty * unit;
+        return `
+          <tr>
+            <td>${index + 1}</td>
+            <td>${escapeHtml(item.name || '-')}</td>
+            <td>${escapeHtml(item.sku || '-')}</td>
+            <td class="ta-right">${escapeHtml(qty)}</td>
+            <td class="ta-right">${formatCurrencyBRL(unit)}</td>
+            <td class="ta-right">${formatCurrencyBRL(subtotal)}</td>
+          </tr>
+        `;
+      })
+      .join('');
+
+    const toSortableTime = (value: unknown) => {
+      const parsed = parseDateLike(value);
+      return parsed ? parsed.getTime() : 0;
+    };
+
+    const historyRows = (order.approvalHistory || [])
+      .slice()
+      .sort((a, b) => toSortableTime(a.at) - toSortableTime(b.at))
+      .map((entry, index) => {
+        const when = formatDateTimePtBR(entry.at, '--/--/---- --:--:--');
+        const actionLabel =
+          entry.action === 'approved'
+            ? 'Aprovação registrada'
+            : entry.action === 'rejected'
+              ? `Rejeição: ${entry.reason || 'Sem justificativa'}`
+              : entry.description || (entry.status ? `Status alterado: ${PO_STATUS_LABELS[entry.status]}` : 'Status alterado');
+
+        return `
+          <tr>
+            <td>${index + 1}</td>
+            <td>${escapeHtml(when)}</td>
+            <td>${escapeHtml(entry.by || 'Sistema')}</td>
+            <td>${escapeHtml(actionLabel)}</td>
+          </tr>
+        `;
+      })
+      .join('');
+
+    const printableHtml = `
+      <!doctype html>
+      <html lang="pt-BR">
+      <head>
+        <meta charset="utf-8" />
+        <meta name="viewport" content="width=device-width, initial-scale=1" />
+        <title>Detalhamento ${escapeHtml(order.id)}</title>
+        <style>
+          @page { size: A4 portrait; margin: 10mm; }
+          * { box-sizing: border-box; }
+          body {
+            margin: 0;
+            padding: 18px;
+            font-family: "Segoe UI", "Inter", Arial, sans-serif;
+            background: #eef2f7;
+            color: #0f172a;
+          }
+          .sheet {
+            width: 100%;
+            max-width: 190mm;
+            margin: 0 auto;
+            background: #ffffff;
+            border: 1px solid #dbe2ea;
+            border-radius: 16px;
+            overflow: hidden;
+          }
+          .header {
+            display: flex;
+            gap: 14px;
+            align-items: center;
+            border-bottom: 1px solid #e5e7eb;
+            padding: 16px 18px;
+            background: linear-gradient(120deg, #f8fbff 0%, #eff6ff 100%);
+          }
+          .logo {
+            width: 62px;
+            height: 62px;
+            border-radius: 12px;
+            object-fit: cover;
+            border: 1px solid #dbe2ea;
+            background: #ffffff;
+          }
+          .title-wrap h1 {
+            margin: 0;
+            font-size: 18px;
+            line-height: 1.2;
+            font-weight: 800;
+            color: #1e3a8a;
+          }
+          .title-wrap p {
+            margin: 3px 0 0;
+            font-size: 11px;
+            color: #475569;
+            font-weight: 600;
+          }
+          .meta-grid {
+            display: grid;
+            grid-template-columns: repeat(2, minmax(0, 1fr));
+            gap: 8px 14px;
+            padding: 14px 18px;
+            border-bottom: 1px solid #e5e7eb;
+            background: #f8fafc;
+            font-size: 11px;
+          }
+          .meta-grid strong {
+            color: #1e293b;
+            min-width: 88px;
+            display: inline-block;
+          }
+          .content {
+            padding: 14px 18px 18px;
+            display: grid;
+            gap: 12px;
+          }
+          h2 {
+            margin: 0;
+            font-size: 12px;
+            font-weight: 800;
+            text-transform: uppercase;
+            letter-spacing: 0.06em;
+            color: #1e3a8a;
+          }
+          .table-wrap {
+            border: 1px solid #dbe2ea;
+            border-radius: 12px;
+            overflow: hidden;
+          }
+          table {
+            width: 100%;
+            border-collapse: collapse;
+            table-layout: fixed;
+          }
+          thead th {
+            text-align: left;
+            font-size: 10px;
+            text-transform: uppercase;
+            letter-spacing: 0.06em;
+            color: #64748b;
+            padding: 8px 10px;
+            background: #ffffff;
+            border-bottom: 1px solid #e5e7eb;
+          }
+          tbody td {
+            padding: 8px 10px;
+            font-size: 10px;
+            border-bottom: 1px solid #f1f5f9;
+            color: #0f172a;
+            vertical-align: top;
+            word-break: break-word;
+          }
+          tbody tr:last-child td {
+            border-bottom: 0;
+          }
+          .ta-right { text-align: right; }
+          .footer {
+            border-top: 1px solid #e5e7eb;
+            background: #f8fafc;
+            padding: 10px 18px;
+            font-size: 10px;
+            color: #64748b;
+            display: flex;
+            justify-content: space-between;
+            gap: 10px;
+            flex-wrap: wrap;
+          }
+          @media print {
+            body { background: #ffffff; padding: 0; }
+            .sheet {
+              max-width: none;
+              border: none;
+              border-radius: 0;
+              margin: 0;
+            }
+          }
+        </style>
+      </head>
+      <body>
+        <main class="sheet">
+          <header class="header">
+            <img class="logo" src="${logoUrl}" alt="Norte Tech" />
+            <div class="title-wrap">
+              <h1>Detalhamento de Pedido de Compra</h1>
+              <p>Pedido ${escapeHtml(order.id)} • Emitido em ${escapeHtml(issuedAt)}</p>
+            </div>
+          </header>
+
+          <section class="meta-grid">
+            <div><strong>Status:</strong> ${escapeHtml(statusLabel)}</div>
+            <div><strong>Total:</strong> ${formatCurrencyBRL(totalValue)}</div>
+            <div><strong>Placa:</strong> ${escapeHtml(order.plate || '-')}</div>
+            <div><strong>Centro de Custo:</strong> ${escapeHtml(order.costCenter || '-')}</div>
+            <div><strong>Fornecedor:</strong> ${escapeHtml(selectedQuote?.vendorName || order.vendor || '-')}</div>
+            <div><strong>Origem:</strong> ${escapeHtml(order.requester || '-')}</div>
+            <div><strong>Solicitado em:</strong> ${escapeHtml(order.requestDate || '-')}</div>
+            <div><strong>Recebido em:</strong> ${escapeHtml(order.receivedAt || '-')}</div>
+          </section>
+
+          <section class="content">
+            <h2>Itens do Pedido</h2>
+            <div class="table-wrap">
+              <table>
+                <thead>
+                  <tr>
+                    <th>#</th>
+                    <th>Item</th>
+                    <th>SKU</th>
+                    <th class="ta-right">Qtd.</th>
+                    <th class="ta-right">Unitário</th>
+                    <th class="ta-right">Subtotal</th>
+                  </tr>
+                </thead>
+                <tbody>${itemRows || '<tr><td colspan="6">Sem itens no pedido.</td></tr>'}</tbody>
+              </table>
+            </div>
+
+            <h2>Histórico de Status</h2>
+            <div class="table-wrap">
+              <table>
+                <thead>
+                  <tr>
+                    <th>#</th>
+                    <th>Data/Hora</th>
+                    <th>Responsável</th>
+                    <th>Descrição</th>
+                  </tr>
+                </thead>
+                <tbody>${historyRows || '<tr><td colspan="4">Sem histórico disponível.</td></tr>'}</tbody>
+              </table>
+            </div>
+          </section>
+
+          <footer class="footer">
+            <span>Norte Tech WMS • Compras</span>
+            <span>Documento para controle interno e rastreabilidade</span>
+          </footer>
+        </main>
+      </body>
+      </html>
+    `;
+
+    printHtmlDocument(printableHtml);
+  };
+
+  const quoteSlotLabels = ['Primeira', 'Segunda', 'Terceira', 'Quarta', 'Quinta'];
+  const quoteSlotThemes = [
+    {
+      container: 'bg-amber-50 dark:bg-amber-900/10 border-amber-200 dark:border-amber-800',
+      bullet: 'bg-amber-500',
+      title: 'text-amber-700 dark:text-amber-400',
+      inputBorder: 'border-amber-200 dark:border-amber-700 focus:border-amber-500',
+    },
+    {
+      container: 'bg-orange-50 dark:bg-orange-900/10 border-orange-200 dark:border-orange-800',
+      bullet: 'bg-orange-500',
+      title: 'text-orange-700 dark:text-orange-400',
+      inputBorder: 'border-orange-200 dark:border-orange-700 focus:border-orange-500',
+    },
+    {
+      container: 'bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-800',
+      bullet: 'bg-red-500',
+      title: 'text-red-700 dark:text-red-400',
+      inputBorder: 'border-red-200 dark:border-red-700 focus:border-red-500',
+    },
+    {
+      container: 'bg-violet-50 dark:bg-violet-900/10 border-violet-200 dark:border-violet-800',
+      bullet: 'bg-violet-500',
+      title: 'text-violet-700 dark:text-violet-400',
+      inputBorder: 'border-violet-200 dark:border-violet-700 focus:border-violet-500',
+    },
+    {
+      container: 'bg-teal-50 dark:bg-teal-900/10 border-teal-200 dark:border-teal-800',
+      bullet: 'bg-teal-500',
+      title: 'text-teal-700 dark:text-teal-400',
+      inputBorder: 'border-teal-200 dark:border-teal-700 focus:border-teal-500',
+    },
+  ];
+
+  const renderItemQuotationForms = () => {
+    if (!quotingPO) return null;
+
+    return (
+      <div className="px-10 pb-10 pt-4 space-y-8">
+        {quotingPO.items.map((item, itemIndex) => {
+          const visibleSlots = Math.max(1, Math.min(5, itemVisibleQuoteForms[item.sku] ?? 1));
+          const selectedQuoteSlot = quotingPO.selectedQuoteId
+            ? (quotingPO.quotes || []).findIndex((quote) => quote.id === quotingPO.selectedQuoteId)
+            : -1;
+
+          return (
+            <div key={`${item.sku}-${itemIndex}`} className="rounded-3xl border border-slate-100 dark:border-slate-800 bg-slate-50/60 dark:bg-slate-900/40 p-6 space-y-5">
+              <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
+                <div>
+                  <p className="text-xs font-black text-slate-800 dark:text-white">{item.name}</p>
+                  <p className="text-[10px] font-black text-primary uppercase tracking-wider mt-1">Cód. Produto: {item.sku}</p>
+                  <p className="text-[10px] font-bold text-slate-500 mt-1">Quantidade: {item.qty} un.</p>
+                </div>
+
+                <div className="flex items-center gap-3">
+                  <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest">
+                    Cotações abertas: {visibleSlots}/5
+                  </span>
+                  {quotationMode !== 'analyze' && visibleSlots < 5 && (
+                    <button
+                      type="button"
+                      onClick={() =>
+                        setItemVisibleQuoteForms((prev) => ({
+                          ...prev,
+                          [item.sku]: Math.min(5, (prev[item.sku] ?? 1) + 1),
+                        }))
+                      }
+                      className="px-4 py-2 bg-primary text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-blue-600 transition-all"
+                    >
+                      + Adicionar Cotação
+                    </button>
+                  )}
+                </div>
+              </div>
+
+              <div className="grid grid-cols-1 xl:grid-cols-3 gap-5">
+                {Array.from({ length: visibleSlots }).map((_, slotIndex) => {
+                  const form = getItemForm(item.sku, slotIndex);
+                  const searchValue = getItemVendorSearchValue(item.sku, slotIndex);
+                  const isSearchOpen = isItemVendorSearchOpen(item.sku, slotIndex);
+                  const selectedVendorIdsInItem = (itemQuoteForms[item.sku] || [])
+                    .map((entry, index) => (index === slotIndex ? '' : entry.vendorId))
+                    .filter(Boolean);
+                  const vendorCandidates = vendors.filter((vendor) => {
+                    if (String(vendor.status || '').toLowerCase() !== 'ativo') return false;
+                    if (selectedVendorIdsInItem.includes(vendor.id)) return false;
+
+                    const term = String(searchValue || '').trim().toLowerCase();
+                    if (!term) return true;
+
+                    const termDigits = normalize(term);
+                    const vendorName = String(vendor.name || '').toLowerCase();
+                    const vendorCnpj = String(vendor.cnpj || '');
+                    return vendorName.includes(term) || vendorCnpj.includes(term) || (termDigits.length > 0 && normalize(vendorCnpj).includes(termDigits));
+                  });
+
+                  const theme = quoteSlotThemes[slotIndex] || quoteSlotThemes[quoteSlotThemes.length - 1];
+                  const quoteLabel = quoteSlotLabels[slotIndex] || `${slotIndex + 1}ª`;
+                  const isSelectedSuggestion = quotationMode === 'analyze' && selectedQuoteSlot === slotIndex;
+
+                  return (
+                    <div key={`${item.sku}-slot-${slotIndex}`} className={`space-y-4 p-5 rounded-3xl border-2 ${theme.container}`}>
+                      <div className="flex items-center justify-between">
+                        <div className="flex items-center gap-2">
+                          <span className={`size-7 ${theme.bullet} text-white rounded-full flex items-center justify-center text-xs font-black`}>{slotIndex + 1}</span>
+                          <h4 className={`text-[11px] font-black uppercase tracking-widest ${theme.title}`}>{quoteLabel} Cotação</h4>
+                        </div>
+                        <div className="flex items-center gap-2">
+                          {isSelectedSuggestion && (
+                            <span className="px-3 py-1 bg-emerald-500 text-white text-[9px] font-black rounded-lg uppercase tracking-widest">Selecionada</span>
+                          )}
+                          {quotationMode !== 'analyze' && slotIndex > 0 && (
+                            <button
+                              type="button"
+                              onClick={() => removeItemQuoteSlot(item.sku, slotIndex)}
+                              className="size-8 rounded-xl border border-red-300 bg-white/90 text-red-500 hover:bg-red-50 hover:border-red-400 transition-all flex items-center justify-center"
+                              title="Remover esta cotação"
+                              aria-label="Remover cotação"
+                            >
+                              <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+                                <path d="M18 6 6 18" />
+                                <path d="m6 6 12 12" />
+                              </svg>
+                            </button>
+                          )}
+                        </div>
+                      </div>
+
+                      <div className="space-y-2 relative">
+                        <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Fornecedor (CNPJ ou Nome) *</label>
+                        <input
+                          type="text"
+                          value={searchValue}
+                          onChange={(event) => {
+                            const value = event.target.value;
+                            setItemVendorSearchValue(item.sku, slotIndex, value);
+                            updateItemForm(item.sku, slotIndex, { vendorId: '' });
+                            setItemVendorSearchOpenState(item.sku, slotIndex, true);
+                          }}
+                          onFocus={() => setItemVendorSearchOpenState(item.sku, slotIndex, true)}
+                          onBlur={() => {
+                            setTimeout(() => {
+                              setItemVendorSearchOpenState(item.sku, slotIndex, false);
+                            }, 120);
+                          }}
+                          placeholder="Digite CNPJ ou Nome..."
+                          disabled={quotationMode === 'analyze'}
+                          className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70 cursor-not-allowed' : theme.inputBorder}`}
+                        />
+                        {isSearchOpen && searchValue && !form.vendorId && vendorCandidates.length > 0 && (
+                          <div className="absolute z-[110] left-0 right-0 top-full mt-1 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl shadow-2xl overflow-hidden max-h-48 overflow-y-auto">
+                            {vendorCandidates.map((vendor) => (
+                              <button
+                                key={vendor.id}
+                                type="button"
+                                onMouseDown={(event) => {
+                                  event.preventDefault();
+                                  updateItemForm(item.sku, slotIndex, { vendorId: vendor.id });
+                                  setItemVendorSearchValue(item.sku, slotIndex, vendor.name);
+                                  setItemVendorSearchOpenState(item.sku, slotIndex, false);
+                                }}
+                                className="w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800 text-left border-b border-slate-50 dark:border-slate-800 last:border-0"
+                              >
+                                <p className="text-sm font-black text-slate-800 dark:text-white">{vendor.name}</p>
+                                <p className="text-[10px] text-slate-400 font-bold uppercase">{vendor.cnpj}</p>
+                              </button>
+                            ))}
+                          </div>
+                        )}
+                      </div>
+
+                      <div className="space-y-2">
+                        <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Valor Total *</label>
+                        <input
+                          type="number"
+                          step="0.01"
+                          value={form.totalValue}
+                          onChange={(event) => updateItemForm(item.sku, slotIndex, { totalValue: event.target.value })}
+                          placeholder="R$ 0,00"
+                          disabled={quotationMode === 'analyze'}
+                          className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70 cursor-not-allowed' : theme.inputBorder}`}
+                        />
+                      </div>
+
+                      <div className="space-y-2">
+                        <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Prazo de Entrega</label>
+                        <input
+                          type="date"
+                          value={form.validUntil}
+                          onChange={(event) => updateItemForm(item.sku, slotIndex, { validUntil: event.target.value })}
+                          disabled={quotationMode === 'analyze'}
+                          className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70 cursor-not-allowed' : theme.inputBorder}`}
+                        />
+                      </div>
+
+                      <div className="space-y-2">
+                        <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Observações</label>
+                        <textarea
+                          value={form.notes}
+                          onChange={(event) => updateItemForm(item.sku, slotIndex, { notes: event.target.value })}
+                          rows={3}
+                          placeholder="Condições, prazos..."
+                          disabled={quotationMode === 'analyze'}
+                          className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all resize-none ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70 cursor-not-allowed' : theme.inputBorder}`}
+                        />
+                      </div>
+                    </div>
+                  );
+                })}
+              </div>
+            </div>
+          );
+        })}
+      </div>
+    );
+  };
+
   return (
     <div className="space-y-6 animate-in fade-in duration-500">
       <div className="flex flex-col lg:flex-row lg:items-end justify-between gap-4">
@@ -686,7 +1699,7 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
 
       <PaginationBar
         currentPage={currentPage}
-        currentCount={orders.length}
+        currentCount={filteredSortedOrders.length}
         pageSize={pageSize}
         hasNextPage={hasNextPage}
         isLoading={isPageLoading}
@@ -694,21 +1707,69 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
         onPageChange={onPageChange}
       />
 
+      <div className="bg-white dark:bg-slate-900 rounded-2xl border border-slate-200/60 dark:border-slate-800 p-4">
+        <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
+          <div className="relative">
+            <svg xmlns="http://www.w3.org/2000/svg" className="size-4 text-slate-400 absolute left-4 top-1/2 -translate-y-1/2" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+              <circle cx="11" cy="11" r="8" />
+              <path d="m21 21-4.3-4.3" />
+            </svg>
+            <input
+              type="text"
+              value={poSearch}
+              onChange={(e) => setPoSearch(e.target.value)}
+              placeholder="Busca geral (todas as colunas)"
+              className="w-full pl-11 pr-4 py-3 rounded-xl border-2 border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-700 dark:text-slate-100 focus:border-primary transition-all"
+            />
+          </div>
+          <input
+            type="text"
+            value={poPlateFilter}
+            onChange={(e) => setPoPlateFilter(e.target.value)}
+            placeholder="Filtrar por placa"
+            className="w-full px-4 py-3 rounded-xl border-2 border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-700 dark:text-slate-100 focus:border-primary transition-all uppercase"
+          />
+          <div className="flex gap-2">
+            <select
+              value={poCostCenterFilter}
+              onChange={(e) => setPoCostCenterFilter(e.target.value)}
+              className="flex-1 px-4 py-3 rounded-xl border-2 border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-sm font-semibold text-slate-700 dark:text-slate-100 focus:border-primary transition-all"
+            >
+              <option value="">Todos os centros de custo</option>
+              {costCenterOptions.map((center) => (
+                <option key={center} value={center}>{center}</option>
+              ))}
+            </select>
+            <button
+              type="button"
+              onClick={() => {
+                setPoSearch('');
+                setPoPlateFilter('');
+                setPoCostCenterFilter('');
+              }}
+              className="px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-[10px] font-black uppercase tracking-widest text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all"
+            >
+              Limpar
+            </button>
+          </div>
+        </div>
+      </div>
+
       <div className="bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-200/60 dark:border-slate-800 shadow-sm overflow-hidden">
         <div className="overflow-x-auto">
           <table className="w-full text-left">
             <thead>
               <tr className="bg-slate-50/50 dark:bg-slate-800/50 border-b border-slate-100 dark:border-slate-800 text-[10px] font-black text-slate-400 uppercase tracking-widest">
-                <th className="px-8 py-6">ID Pedido</th>
-                <th className="px-8 py-6">Produto / Cód. Produto</th>
-                <th className="px-8 py-6">Fornecedor / Origem</th>
-                <th className="px-8 py-6 text-center">Status</th>
-                <th className="px-8 py-6 text-center">Prioridade</th>
+                <th className="px-8 py-6 cursor-pointer select-none" onClick={() => togglePoSort('id')}>ID Pedido {poSortKey === 'id' ? (poSortDirection === 'asc' ? '↑' : '↓') : ''}</th>
+                <th className="px-8 py-6 cursor-pointer select-none" onClick={() => togglePoSort('product')}>Produto / Cód. Produto {poSortKey === 'product' ? (poSortDirection === 'asc' ? '↑' : '↓') : ''}</th>
+                <th className="px-8 py-6 cursor-pointer select-none" onClick={() => togglePoSort('plateCenter')}>Placa / Centro de Custo {poSortKey === 'plateCenter' ? (poSortDirection === 'asc' ? '↑' : '↓') : ''}</th>
+                <th className="px-8 py-6 text-center cursor-pointer select-none" onClick={() => togglePoSort('status')}>Status {poSortKey === 'status' ? (poSortDirection === 'asc' ? '↑' : '↓') : ''}</th>
+                <th className="px-8 py-6 text-center cursor-pointer select-none" onClick={() => togglePoSort('priority')}>Prioridade {poSortKey === 'priority' ? (poSortDirection === 'asc' ? '↑' : '↓') : ''}</th>
                 <th className="px-8 py-6 text-right">Ações</th>
               </tr>
             </thead>
             <tbody className="divide-y divide-slate-100 dark:divide-slate-800">
-              {orders.length > 0 ? orders.map((order) => (
+              {filteredSortedOrders.length > 0 ? filteredSortedOrders.map((order) => (
                 <tr key={order.id} className="hover:bg-slate-50/80 dark:hover:bg-slate-800/30 transition-colors group">
                   <td className="px-8 py-5">
                     <span className="font-black text-sm text-slate-800 dark:text-white">{order.id}</span>
@@ -724,9 +1785,9 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
                     </div>
                   </td>
                   <td className="px-8 py-5">
-                    <p className="text-sm font-black text-slate-800 dark:text-white">{order.vendor}</p>
+                    <p className="text-sm font-black text-slate-800 dark:text-white uppercase">{order.plate || '-'}</p>
                     <p className="text-[10px] text-primary font-black uppercase tracking-tight">
-                      {order.requester || 'Solicitação Manual'}
+                      {order.costCenter || '-'}
                     </p>
                   </td>
                   <td className="px-8 py-5 text-center">
@@ -800,14 +1861,12 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
                       {user.role === 'admin' && (
                         <button
                           onClick={() => {
-                            if (order.status === 'recebido') return;
                             if (window.confirm(`Deseja remover o pedido ${order.id}?`)) {
                               onDeleteOrder(order.id);
                             }
                           }}
-                          disabled={order.status === 'recebido'}
-                          title={order.status === 'recebido' ? 'Pedido recebido não pode ser removido.' : 'Remover pedido'}
-                          className="px-4 py-2 bg-red-500 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-red-600 transition-all active:scale-95 disabled:bg-red-200 disabled:text-red-50 disabled:cursor-not-allowed"
+                          title="Remover pedido"
+                          className="px-4 py-2 bg-red-500 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-red-600 transition-all active:scale-95"
                         >
                           Remover
                         </button>
@@ -818,7 +1877,7 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               )) : (
                 <tr>
                   <td colSpan={6} className="px-8 py-20 text-center text-slate-400 font-black uppercase text-xs tracking-widest">
-                    {isPageLoading ? 'Carregando pedidos...' : 'Nenhum pedido de compra registrado.'}
+                    {isPageLoading ? 'Carregando pedidos...' : 'Nenhum pedido de compra encontrado para o filtro informado.'}
                   </td>
                 </tr>
               )}
@@ -1157,6 +2216,17 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               <div>
                 <h3 className="text-3xl font-black text-slate-800 dark:text-white tracking-tight">Detalhamento {viewingOrder.id}</h3>
                 <p className="text-xs font-black text-slate-400 uppercase tracking-widest mt-1">Gestão Completa do Fluxo de Suprimentos</p>
+                <div className="mt-3 flex flex-wrap items-center gap-2">
+                  <span className="px-3 py-1 rounded-xl bg-slate-100 dark:bg-slate-800 text-[10px] font-black uppercase tracking-widest text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700">
+                    Placa: {viewingOrder.plate || '-'}
+                  </span>
+                  <span className="px-3 py-1 rounded-xl bg-slate-100 dark:bg-slate-800 text-[10px] font-black uppercase tracking-widest text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700">
+                    Centro de Custo: {viewingOrder.costCenter || '-'}
+                  </span>
+                  <span className="px-3 py-1 rounded-xl bg-slate-100 dark:bg-slate-800 text-[10px] font-black uppercase tracking-widest text-slate-700 dark:text-slate-200 border border-slate-200 dark:border-slate-700">
+                    Origem: {viewingOrder.requester || 'Solicitação Manual'}
+                  </span>
+                </div>
               </div>
               <button
                 onClick={() => setViewingOrder(null)}
@@ -1170,7 +2240,10 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
             </div>
 
             <div className="flex-1 overflow-y-auto p-10 pt-0 pb-10 space-y-8 scrollbar-hide">
-              <StatusProgressBar order={viewingOrder} />
+              <StatusProgressBar
+                order={viewingOrder}
+                onPrint={() => handlePrintOrderDetailSheet(viewingOrder)}
+              />
 
               <div className="space-y-4">
                 <h4 className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4">Itens do Pedido</h4>
@@ -1228,6 +2301,18 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               </div>
 
               <div className="flex items-center gap-4">
+                <button
+                  onClick={handlePrintQuotationSheet}
+                  className="px-6 py-3 bg-gradient-to-r from-slate-800 to-slate-700 text-white border border-slate-700 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:from-slate-900 hover:to-slate-800 transition-all shadow-lg shadow-slate-900/20 flex items-center gap-2"
+                  title="Abrir layout de impressão com seleção de impressora"
+                >
+                  <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+                    <polyline points="6 9 6 2 18 2 18 9" />
+                    <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" />
+                    <rect width="12" height="8" x="6" y="14" />
+                  </svg>
+                  Imprimir
+                </button>
                 <button
                   onClick={() => { setIsQuotationModalOpen(false); resetQuotationForm(); }}
                   className="px-6 py-3 bg-white dark:bg-slate-800 text-slate-400 border border-slate-200 dark:border-slate-700 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-slate-100 transition-all"
@@ -1272,17 +2357,25 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
 
             <div className="px-10 mb-2">
               <div className="bg-slate-50 dark:bg-slate-800/50 rounded-2xl p-6 border border-slate-100 dark:border-slate-800">
-                <h4 className="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2">
-                  <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
-                    <line x1="8" y1="6" x2="21" y2="6" />
-                    <line x1="8" y1="12" x2="21" y2="12" />
-                    <line x1="8" y1="18" x2="21" y2="18" />
-                    <line x1="3" y1="6" x2="3.01" y2="6" />
-                    <line x1="3" y1="12" x2="3.01" y2="12" />
-                    <line x1="3" y1="18" x2="3.01" y2="18" />
-                  </svg>
-                  Itens a Cotar
-                </h4>
+                <div className="flex flex-col lg:flex-row lg:items-start justify-between gap-4 mb-4">
+                  <h4 className="text-[11px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2">
+                    <svg xmlns="http://www.w3.org/2000/svg" className="size-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
+                      <line x1="8" y1="6" x2="21" y2="6" />
+                      <line x1="8" y1="12" x2="21" y2="12" />
+                      <line x1="8" y1="18" x2="21" y2="18" />
+                      <line x1="3" y1="6" x2="3.01" y2="6" />
+                      <line x1="3" y1="12" x2="3.01" y2="12" />
+                      <line x1="3" y1="18" x2="3.01" y2="18" />
+                    </svg>
+                    Itens a Cotar
+                  </h4>
+                  <div className="grid grid-cols-2 gap-x-6 gap-y-1 text-sm font-black text-slate-800 dark:text-white">
+                    <span>PLACA: <span className="font-semibold text-slate-600 dark:text-slate-300">{quotingPO.plate || '-'}</span></span>
+                    <span>ANO: <span className="font-semibold text-slate-600 dark:text-slate-300">{selectedVehicle?.year ?? '-'}</span></span>
+                    <span>CHASSI: <span className="font-semibold text-slate-600 dark:text-slate-300">{selectedVehicle?.chassis || '-'}</span></span>
+                    <span>RENAVAM: <span className="font-semibold text-slate-600 dark:text-slate-300">{selectedVehicle?.renavam || '-'}</span></span>
+                  </div>
+                </div>
                 <div className="space-y-3">
                   {quotingPO.items.map((item, idx) => (
                     <div key={idx} className="flex justify-between items-center text-sm border-b border-dashed border-slate-200 dark:border-slate-700 pb-2 last:border-0 last:pb-0">
@@ -1363,6 +2456,23 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               </div>
             </div>
 
+            {renderItemQuotationForms()}
+            {false && (
+              <>
+            <div className="px-10 pt-6 flex items-center justify-between">
+              <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest">
+                Cotações abertas: {visibleQuoteForms}/5
+              </p>
+              {quotationMode !== 'analyze' && visibleQuoteForms < 5 && (
+                <button
+                  type="button"
+                  onClick={() => setVisibleQuoteForms((prev) => Math.min(5, prev + 1))}
+                  className="px-4 py-2 bg-primary text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-blue-600 transition-all"
+                >
+                  + Adicionar Cotação
+                </button>
+              )}
+            </div>
             <div className="p-10 grid grid-cols-1 lg:grid-cols-3 gap-8 pt-2">
               {/* Cotação 1 */}
               <div className="space-y-4 p-6 bg-amber-50 dark:bg-amber-900/10 rounded-3xl border-2 border-amber-200 dark:border-amber-800">
@@ -1460,7 +2570,7 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               </div>
 
               {/* Cotação 2 */}
-              <div className="space-y-4 p-6 bg-orange-50 dark:bg-orange-900/10 rounded-3xl border-2 border-orange-200 dark:border-orange-800">
+              <div className={`space-y-4 p-6 bg-orange-50 dark:bg-orange-900/10 rounded-3xl border-2 border-orange-200 dark:border-orange-800 ${visibleQuoteForms < 2 ? 'hidden' : ''}`}>
                 <div className="flex items-center justify-between mb-4">
                   <div className="flex items-center gap-2">
                     <span className="size-8 bg-orange-500 text-white rounded-full flex items-center justify-center text-sm font-black">2</span>
@@ -1555,7 +2665,7 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
               </div>
 
               {/* Cotação 3 */}
-              <div className="space-y-4 p-6 bg-red-50 dark:bg-red-900/10 rounded-3xl border-2 border-red-200 dark:border-red-800">
+              <div className={`space-y-4 p-6 bg-red-50 dark:bg-red-900/10 rounded-3xl border-2 border-red-200 dark:border-red-800 ${visibleQuoteForms < 3 ? 'hidden' : ''}`}>
                 <div className="flex items-center justify-between mb-4">
                   <div className="flex items-center gap-2">
                     <span className="size-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-black">3</span>
@@ -1648,8 +2758,178 @@ export const PurchaseOrders: React.FC<PurchaseOrdersProps> = ({
                   />
                 </div>
               </div>
+
+              <div className={`space-y-4 p-6 bg-violet-50 dark:bg-violet-900/10 rounded-3xl border-2 border-violet-200 dark:border-violet-800 ${visibleQuoteForms < 4 ? 'hidden' : ''}`}>
+                <div className="flex items-center justify-between mb-4">
+                  <div className="flex items-center gap-2">
+                    <span className="size-8 bg-violet-500 text-white rounded-full flex items-center justify-center text-sm font-black">4</span>
+                    <h4 className="text-sm font-black text-violet-700 dark:text-violet-400 uppercase tracking-widest">Quarta Cotação</h4>
+                  </div>
+                </div>
+                <div className="space-y-2 relative" ref={quote4SearchRef}>
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Fornecedor (CNPJ ou Nome) *</label>
+                  <input
+                    type="text"
+                    value={quote4Search}
+                    onChange={(e) => {
+                      setQuote4Search(e.target.value);
+                      if (quote4Vendor) setQuote4Vendor('');
+                      setIsQuote4SearchOpen(true);
+                    }}
+                    onFocus={() => setIsQuote4SearchOpen(true)}
+                    placeholder="Digite CNPJ ou Nome..."
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-violet-200 dark:border-violet-700 focus:border-violet-500'}`}
+                  />
+                  {isQuote4SearchOpen && quote4Search && !quote4Vendor && (
+                    <div className="absolute z-[110] left-0 right-0 top-full mt-1 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl shadow-2xl overflow-hidden max-h-48 overflow-y-auto">
+                      {vendors.filter(v => {
+                        if ((v.status || '').toLowerCase() !== 'ativo') return false;
+                        const s = quote4Search.toLowerCase().trim();
+                        const sNorm = normalize(s);
+                        const vName = String(v.name || '').toLowerCase();
+                        const vCnpj = String(v.cnpj || '');
+                        const vCnpjNorm = normalize(vCnpj);
+                        return vName.includes(s) || vCnpj.includes(s) || (sNorm.length > 0 && vCnpjNorm.includes(sNorm));
+                      }).map(v => (
+                        <button
+                          key={v.id}
+                          onClick={() => {
+                            setQuote4Vendor(v.id);
+                            setQuote4Search(v.name);
+                            setIsQuote4SearchOpen(false);
+                          }}
+                          className="w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800 text-left border-b border-slate-50 dark:border-slate-800 last:border-0"
+                        >
+                          <p className="text-sm font-black text-slate-800 dark:text-white">{v.name}</p>
+                          <p className="text-[10px] text-slate-400 font-bold uppercase">{v.cnpj}</p>
+                        </button>
+                      ))}
+                    </div>
+                  )}
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Valor Total *</label>
+                  <input
+                    type="number"
+                    step="0.01"
+                    value={quote4Price}
+                    onChange={e => setQuote4Price(e.target.value)}
+                    placeholder="R$ 0,00"
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-violet-200 dark:border-violet-700 focus:border-violet-500'}`}
+                  />
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Prazo de Entrega</label>
+                  <input
+                    type="date"
+                    value={quote4Valid}
+                    onChange={e => setQuote4Valid(e.target.value)}
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-violet-200 dark:border-violet-700 focus:border-violet-500'}`}
+                  />
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Observações</label>
+                  <textarea
+                    value={quote4Notes}
+                    onChange={e => setQuote4Notes(e.target.value)}
+                    rows={3}
+                    placeholder="Condições, prazos..."
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all resize-none ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-violet-200 dark:border-violet-700 focus:border-violet-500'}`}
+                  />
+                </div>
+              </div>
+
+              <div className={`space-y-4 p-6 bg-teal-50 dark:bg-teal-900/10 rounded-3xl border-2 border-teal-200 dark:border-teal-800 ${visibleQuoteForms < 5 ? 'hidden' : ''}`}>
+                <div className="flex items-center justify-between mb-4">
+                  <div className="flex items-center gap-2">
+                    <span className="size-8 bg-teal-500 text-white rounded-full flex items-center justify-center text-sm font-black">5</span>
+                    <h4 className="text-sm font-black text-teal-700 dark:text-teal-400 uppercase tracking-widest">Quinta Cotação</h4>
+                  </div>
+                </div>
+                <div className="space-y-2 relative" ref={quote5SearchRef}>
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Fornecedor (CNPJ ou Nome) *</label>
+                  <input
+                    type="text"
+                    value={quote5Search}
+                    onChange={(e) => {
+                      setQuote5Search(e.target.value);
+                      if (quote5Vendor) setQuote5Vendor('');
+                      setIsQuote5SearchOpen(true);
+                    }}
+                    onFocus={() => setIsQuote5SearchOpen(true)}
+                    placeholder="Digite CNPJ ou Nome..."
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-teal-200 dark:border-teal-700 focus:border-teal-500'}`}
+                  />
+                  {isQuote5SearchOpen && quote5Search && !quote5Vendor && (
+                    <div className="absolute z-[110] left-0 right-0 top-full mt-1 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl shadow-2xl overflow-hidden max-h-48 overflow-y-auto">
+                      {vendors.filter(v => {
+                        if ((v.status || '').toLowerCase() !== 'ativo') return false;
+                        const s = quote5Search.toLowerCase().trim();
+                        const sNorm = normalize(s);
+                        const vName = String(v.name || '').toLowerCase();
+                        const vCnpj = String(v.cnpj || '');
+                        const vCnpjNorm = normalize(vCnpj);
+                        return vName.includes(s) || vCnpj.includes(s) || (sNorm.length > 0 && vCnpjNorm.includes(sNorm));
+                      }).map(v => (
+                        <button
+                          key={v.id}
+                          onClick={() => {
+                            setQuote5Vendor(v.id);
+                            setQuote5Search(v.name);
+                            setIsQuote5SearchOpen(false);
+                          }}
+                          className="w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800 text-left border-b border-slate-50 dark:border-slate-800 last:border-0"
+                        >
+                          <p className="text-sm font-black text-slate-800 dark:text-white">{v.name}</p>
+                          <p className="text-[10px] text-slate-400 font-bold uppercase">{v.cnpj}</p>
+                        </button>
+                      ))}
+                    </div>
+                  )}
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Valor Total *</label>
+                  <input
+                    type="number"
+                    step="0.01"
+                    value={quote5Price}
+                    onChange={e => setQuote5Price(e.target.value)}
+                    placeholder="R$ 0,00"
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-teal-200 dark:border-teal-700 focus:border-teal-500'}`}
+                  />
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Prazo de Entrega</label>
+                  <input
+                    type="date"
+                    value={quote5Valid}
+                    onChange={e => setQuote5Valid(e.target.value)}
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-teal-200 dark:border-teal-700 focus:border-teal-500'}`}
+                  />
+                </div>
+                <div className="space-y-2">
+                  <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Observações</label>
+                  <textarea
+                    value={quote5Notes}
+                    onChange={e => setQuote5Notes(e.target.value)}
+                    rows={3}
+                    placeholder="Condições, prazos..."
+                    disabled={quotationMode === 'analyze'}
+                    className={`w-full px-4 py-3 bg-white dark:bg-slate-800 border-2 rounded-xl font-bold text-sm transition-all resize-none ${quotationMode === 'analyze' ? 'border-slate-100 dark:border-slate-700 opacity-70' : 'border-teal-200 dark:border-teal-700 focus:border-teal-500'}`}
+                  />
+                </div>
+              </div>
             </div>
 
+              </>
+            )}
             {/* Footer removed to move buttons to header */}
           </div>
         </div>
